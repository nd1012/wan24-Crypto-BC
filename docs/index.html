<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>wan24-Crypto-BC | wan24-Crypto-BC </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="wan24-Crypto-BC | wan24-Crypto-BC ">
      <meta name="generator" content="docfx ">
  
      <link rel="shortcut icon" href="favicon.ico">
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/night-owl.min.css">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" integrity="sha384-EvBWSlnoFgZlXJvpzS+MAUEjvN7+gcCwH+qh7GRFOGgZO0PuwOFro7qPOJnLfe7l" crossorigin="anonymous">
      <link rel="stylesheet" href="styles/config.css">
      <link rel="stylesheet" href="styles/singulink.css">
      <link rel="stylesheet" href="styles/main.css">
      <meta property="docfx:navrel" content="toc.html">
      <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="">
  <meta property="docfx:newtab" content="true">
    </head>
    <body>
        <!-- Header required for docfx anchor scroll to work -->
        <header id="head"></header>
        <div class="top-navbar">
            <a class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="34" height="34" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>


            <a class="brand" href="index.html">
              <img src="logo.svg" alt="" class="logomark">
              <span class="brand-title"></span>
            </a>        </div>

        <div class="body-content">
            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">
                <div class="sidebar">

                    <div>
                      <div class="mobile-hide">

                        <a class="brand" href="index.html">
                          <img src="logo.svg" alt="" class="logomark">
                          <span class="brand-title"></span>
                        </a>                      </div>

                      <div class="sidesearch">
                        <form id="search" role="search" class="search">
                            <i class="bi bi-search search-icon"></i>
                            <input type="text" id="search-query" placeholder="Search" autocomplete="off">
                        </form>
                      </div>

                      <div id="navbar">
                      </div>
                    </div>                    <div class="sidebar-item-separator"></div>
                </div>
                <div class="footer">
  (c) 2023 Andreas Zimmermann, wan24.de
  
                </div>            </nav>

            <main class="main-panel">

                <div id="search-results" style="display: none;">
                  <h1 class="search-list">Search Results for <span></span></h1>
                  <div class="sr-items">
                    <p><i class="bi bi-hourglass-split index-loading"></i></p>
                  </div>
                  <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
                </div>
 

                <div role="main" class="hide-when-search">

                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                         <div id="contribution">
                               <a href="https://github.com/nd1012/wan24-Crypto-BC/blob/main/src/wan24-Crypto-BC Docs/index.md/#L1" class="contribution-link">Edit this page</a>
                         </div>

                    <article class="content wrap" id="_content" data-uid="">
<h1 id="wan24-crypto-bc">wan24-Crypto-BC</h1>

<p>This library adopts
<a href="https://github.com/bcgit/bc-csharp">The Bouncy Castle Cryptography Library For .NET</a>
to <a href="https://www.nuget.org/packages/wan24-Crypto/">wan24-Crypto</a> and extends
the <code>wan24-Crypto</code> library with these algorithms:</p>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>ID</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Asymmetric</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>CRYSTALS-Kyber</td>
<td>2</td>
<td>CRYSTALSKYBER</td>
</tr>
<tr>
<td>CRYSTALS-Dilithium</td>
<td>3</td>
<td>CRYSTALSDILITHIUM</td>
</tr>
<tr>
<td>FALCON</td>
<td>4</td>
<td>FALCON</td>
</tr>
<tr>
<td>SPHINCS+</td>
<td>5</td>
<td>SPHINCSPLUS</td>
</tr>
<tr>
<td>FrodoKEM</td>
<td>6</td>
<td>FRODOKEM</td>
</tr>
<tr>
<td>NTRUEncrypt</td>
<td>7</td>
<td>NTRUENCRYPT</td>
</tr>
<tr>
<td>Ed25519</td>
<td>8</td>
<td>ED25519</td>
</tr>
<tr>
<td>Ed448</td>
<td>9</td>
<td>ED448</td>
</tr>
<tr>
<td>X25519</td>
<td>10</td>
<td>X25519</td>
</tr>
<tr>
<td>X448</td>
<td>11</td>
<td>X448</td>
</tr>
<tr>
<td>XEd25519</td>
<td>12</td>
<td>XED25519</td>
</tr>
<tr>
<td>XEd448</td>
<td>13</td>
<td>XED448</td>
</tr>
<tr>
<td>Streamlined NTRU Prime</td>
<td>14</td>
<td>SNTRUP</td>
</tr>
<tr>
<td>BIKE</td>
<td>15</td>
<td>BIKE</td>
</tr>
<tr>
<td>HQC</td>
<td>16</td>
<td>HQC</td>
</tr>
<tr>
<td>Picnic</td>
<td>17</td>
<td>PICNIC</td>
</tr>
<tr>
<td><strong>Symmetric</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ChaCha20</td>
<td>1</td>
<td>CHACHA20</td>
</tr>
<tr>
<td>XSalsa20</td>
<td>2</td>
<td>XSALSA20</td>
</tr>
<tr>
<td>AES-256-GCM AEAD (128 bit MAC)</td>
<td>3</td>
<td>AES256GCM</td>
</tr>
<tr>
<td>Serpent 256 CBC (ISO10126 padding)</td>
<td>5</td>
<td>SERPENT256CBC</td>
</tr>
<tr>
<td>Serpent 256 GCM AEAD (128 bit MAC)</td>
<td>6</td>
<td>SERPENT256GCM</td>
</tr>
<tr>
<td>Twofish 256 CBC (ISO10126 padding)</td>
<td>7</td>
<td>TWOFISH256CBC</td>
</tr>
<tr>
<td>Twofish 256 GCM AEAD (128 bit MAC)</td>
<td>8</td>
<td>TWOFISH256GCM</td>
</tr>
</tbody>
</table>
<p>Main goals of this extension library are to make <code>wan24-Crypto</code> usable on all
platforms and extend its algorithms by PQC algorithms and other non-PQC
algorithms, which are not available from .NET, but implemented in the Bouncy
Castle library.</p>
<h2 id="how-to-get-it">How to get it</h2>
<p>This library is available as
<a href="https://www.nuget.org/packages/wan24-Crypto-BC/">NuGet package</a>.</p>
<h2 id="usage">Usage</h2>
<p>In case you don't use the <code>wan24-Core</code> bootstrapper logic, you need to
initialize the Bouncy Castle extension first, before you can use it:</p>
<pre><code class="lang-cs">wan24.Crypto.BC.Bootstrap.Boot();
</code></pre>
<p>This will register the algorithms to the <code>wan24-Crypto</code> library.</p>
<h3 id="wan24-crypto-algorithm-replacement"><code>wan24-Crypto</code> algorithm replacement</h3>
<p>Some algorithms of the <code>wan24-Crypto</code> library are not available on some
platforms, that's why they need to be replaced in order to be used:</p>
<table>
<thead>
<tr>
<th><code>wan24-Crypto</code></th>
<th><code>wan24-Crypto-BC</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AsymmetricEcDiffieHellmanAlgorithm</code></td>
<td><code>AsymmetricBcEcDiffieHellmanAlgorithm</code></td>
</tr>
<tr>
<td><code>AsymmetricEcDsaAlgorithm</code></td>
<td><code>AsymmetricBcEcDsaAlgorithm</code></td>
</tr>
<tr>
<td><code>EncryptionAes256CbcAlgorithm</code></td>
<td><code>EncryptionBcAes256CbcAlgorithm</code></td>
</tr>
<tr>
<td><code>HashShake128Algorithm</code></td>
<td><code>HashBcShake128Algorithm</code></td>
</tr>
<tr>
<td><code>HashShake256Algorithm</code></td>
<td><code>HashBcShake256Algorithm</code></td>
</tr>
<tr>
<td><code>HashSha3_256Algorithm</code></td>
<td><code>HashBcSha3_256Algorithm</code></td>
</tr>
<tr>
<td><code>HashSha3_384Algorithm</code></td>
<td><code>HashBcSha3_384Algorithm</code></td>
</tr>
<tr>
<td><code>HashSha3_512Algorithm</code></td>
<td><code>HashBcSha3_512Algorithm</code></td>
</tr>
<tr>
<td><code>MacHmacSha3_256Algorithm</code></td>
<td><code>MacBcHmacSha3_256Algorithm</code></td>
</tr>
<tr>
<td><code>MacHmacSha3_384Algorithm</code></td>
<td><code>MacBcHmacSha3_384Algorithm</code></td>
</tr>
<tr>
<td><code>MacHmacSha3_512Algorithm</code></td>
<td><code>MacBcHmacSha3_512Algorithm</code></td>
</tr>
</tbody>
</table>
<p>To replace all of them:</p>
<pre><code class="lang-cs">BouncyCastle.ReplaceNetAlgorithms();
</code></pre>
<p><strong>NOTE</strong>: The Shake128/256 replacements don't support variable output length
and use the default output length of the <code>wan24-Crypto</code> implementations
instead. The <code>NetShake128/256HashAlgorithmAdapter</code> can't be replaced for this
reason.</p>
<p>In order to override the .NET default SHA3 hash and HMAC algorithms, you can
call:</p>
<pre><code class="lang-cs">BouncyCastle.RegisterNetAlgorithms();
</code></pre>
<p>This will use Bouncy Castle SHA3 implementations for the .NET implemented SHA3
hash algorithms:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>SHA3-256</td>
<td><code>HashBcSha3_256.SHA3_256</code></td>
</tr>
<tr>
<td>SHA3-384</td>
<td><code>HashBcSha3_384.SHA3_384</code></td>
</tr>
<tr>
<td>SHA3-512</td>
<td><code>HashBcSha3_512.SHA3_512</code></td>
</tr>
<tr>
<td>HMACSHA3-256</td>
<td><code>MacBcHmacSha3_256.HMACSHA3_256</code></td>
</tr>
<tr>
<td>HMACSHA3-384</td>
<td><code>MacBcHmacSha3_384.HMACSHA3_384</code></td>
</tr>
<tr>
<td>HMACSHA3-512</td>
<td><code>MacBcHmacSha3_512.HMACSHA3_512</code></td>
</tr>
</tbody>
</table>
<p>This step is required, if you want to ensure that whenever a .NET crypto type
or any 3rd party crypto type requests a SHA3 hash or HMAC instance using the
static <code>HashAlgorithm.Create(&quot;NAME&quot;)</code> or <code>KeyedHashAlgorithm.Create(&quot;NAME&quot;)</code>
methods.</p>
<h3 id="use-as-default-algorithms">Use as default algorithms</h3>
<p>To set Bouncy Castle defaults as <code>wan24-Crypto</code> defaults:</p>
<pre><code class="lang-cs">BouncyCastle.SetDefaults();
</code></pre>
<p>Per default the current <code>wan24-Crypto</code> default will be set as counter
algorithms to <code>HybridAlgorithmHelper</code>.</p>
<p>Current Bouncy Castle default algorithms are:</p>
<table>
<thead>
<tr>
<th>Usage</th>
<th>Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>Key exchange</td>
<td>NTRUEncrypt</td>
</tr>
<tr>
<td>Signature</td>
<td>CRYSTALS-Dilithium</td>
</tr>
<tr>
<td>Encryption</td>
<td>Serpent 256 bit CBC</td>
</tr>
<tr>
<td>PAKE encryption</td>
<td>Serpent 256 bit GCM</td>
</tr>
</tbody>
</table>
<h2 id="post-quantum-safety">Post quantum safety</h2>
<p>These asymmetric algorithms are designed for post quantum cryptography:</p>
<ul>
<li>CRYSTALS-Kyber (key exchange)</li>
<li>CRYSTALS-Dilithium (signature)</li>
<li>FALCON (signature)</li>
<li>SPHINCS+ (signature)</li>
<li>FrodoKEM (key exchange)</li>
<li>NTRUEncrypt (key exchange)</li>
<li>Streamlined NTRU Prime (key exchange)</li>
<li>BIKE (key exchange)</li>
<li>HQC (key exchange)</li>
<li>Picnic (signature)</li>
</ul>
<p>Normally you want to use them in hybrid mode and use classical algorithms of
the <code>wan24-Crypto</code> package as counter algorithm. To do this per default:</p>
<pre><code class="lang-cs">// Enable the post quantum algorithms as (counter-)defaults
CryptoHelper.ForcePostQuantumSafety();
</code></pre>
<p>This will use these algorithms as (counter) algorithms for asymmetric
cryptography, in case you didn't define other post quantum algorithms already:</p>
<ul>
<li>NTRUEncrypt (key exchange)</li>
<li>CRYSTALS-Dilithium (signature)</li>
</ul>
<p>The counter algorithm will come in effect, if you use asymmetric keys for
encryption:</p>
<pre><code class="lang-cs">// Create options having a counter private key
CryptoOptions options = EncryptionHelper.GetDefaultOptions();
options.SetCounterPrivateKey(yourNtruPrivateKey);

// Encrypt using the options and your normal private key
byte[] cipherData = rawData.Encrypt(yourNormalPrivateKey, options);
rawData = cipherData.Decrypt(yourNormalPrivateKey, options);
</code></pre>
<p>And for signature:</p>
<pre><code class="lang-cs">// Create options having a counter private key
CryptoOptions options = AsymmetricHelper.GetDefaultSignatureOptions();
options.SetCounterPrivateKey(yourDilithiumPrivateKey);

// Sign using the options and your normal private key
SignatureContainer signature = dataToSign.Sign(yourNormalPrivateKey, options: options);
</code></pre>
<h2 id="algorithm-parameters-used">Algorithm parameters used</h2>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td>CRYSTALS-Kyber, CRYSTALS-Dilithium</td>
<td>non-AES</td>
</tr>
<tr>
<td>SPHINCS+</td>
<td>Haraka simple*</td>
</tr>
<tr>
<td>FrodoKEM</td>
<td>AES*</td>
</tr>
<tr>
<td>Picnic</td>
<td>Full</td>
</tr>
</tbody>
</table>
<p><strong>NOTE</strong>: CRYSTALS-Kyber and CRYSTALS-Dilithium AES parameters and SPHINCS+
robust parameters are deprecated! SPHINCS+ Haraka parameters are removed from
the FIPS standard, so <code>wan24-Crypto-BC</code> will switch to Shake parameters
instead. Also the FrodoKEM Shake parameters will be used in the next major
release, which will require to renew existing keys, which use the AES
parameters from the current version of this library.</p>
<p><strong>WARNING</strong> The PQC standards are in development at the moment, so future
incompatible changes are very likely and will be handled in a new major
release of this library.</p>
<h2 id="random-data-provider">Random data provider</h2>
<p>The <code>RandomDataProvider</code> is a <code>RandomDataGenerator</code> which provides added seed
data to <code>OnSeed(Async)</code> attached event handlers. It uses the <code>ChaCha20Rng</code> in
combination with <code>RND</code> of <code>wan24-Crypto</code> to produce cryptographic secure
random data (CSRNG). An instance may be set as <code>RND.Generator</code> singleton
random data generator for all consumers (like key generators etc.).</p>
<p><code>RandomDataProvider</code> can be customized by extending the type. Pregnant methods
are virtual and can be overridden. Since the type is a <code>HostedServiceBase</code>, it
can be used in modern .NET app environments. And since it implements the
<code>IRandomGenerator</code> interface of Bouncy Castle, it can be used as secure random
data source for all Bouncy Castle algorithms (like key generators) also.</p>
<p>By calling the <code>CreateFork(Async)</code> method, you can create an attached
instance, which will be initialized with a random seed generated by the parent
instance and consumes the provided seeds from the parent automatically.</p>
<p><strong>NOTE</strong>: Don't forget to dispose an unused <code>RandomDataProvider</code> instance!</p>
<p><strong>CAUTION</strong>: There is a patent (US10402172B1) which comes into play, if you
plan to create a Random or Entropy as a Service (R/EaaS) application,
especially when using QRNG entropy. Read that document carefully to avoid
disappointments.</p>
<h2 id="stream-cipher-rng">Stream cipher RNG</h2>
<p>The <code>StreamCipherRng</code> uses any stream cipher to encrypt the generated random
bytes of an underlaying PRNG using a random key. The result is a CSRNG. These
stream ciphers are available with <code>wan24-Crypto-BC</code>, but you could use any
other stream cipher (but not AEAD implementations!) also:</p>
<table>
<thead>
<tr>
<th>Stream cipher</th>
<th>RNG</th>
</tr>
</thead>
<tbody>
<tr>
<td>ChaCha20</td>
<td><code>ChaCha20Rng</code></td>
</tr>
<tr>
<td>XSalsa20</td>
<td><code>XSalsa20Rng</code></td>
</tr>
</tbody>
</table>
<p>If you didn't specify an underlaying PRNG, Bouncy Castle's
<code>VmpcRandomGenerator</code> will be used and seeded using 256 bytes from <code>RND</code>.</p>
<p>The final CSRNG implements <code>IRandomGenerator</code> for use with Bouncy Castle, and
also <code>ISeedableRng</code> for use with <code>RND</code> (as seed consumer, for example).</p>
<p><strong>NOTE</strong>: A <code>StreamCipherRng</code> needs to be disposed after use!</p>
<p>You can use the resulting CSRNG as default RNG for <code>RND</code>:</p>
<pre><code class="lang-cs">ChaCha20Rng csrng = new();

// Enable automatic seeding
RND.SeedConsumer = csrng;

// Use as default CSRNG
RND.FillBytes = csrng.GetBytes;
RND.FillBytesAsync = csrng.GetBytesAsync;
</code></pre>
<p><strong>NOTE</strong>: When setting the <code>RND.FillBytes(Async)</code> callbacks, they may not be
used, if <code>/dev/random</code> was preferred. To disable <code>/dev/random</code>, set
<code>RND.UseDevRandom</code> and <code>RND.RequireDevRandom</code> to <code>false</code> also.</p>
<p><strong>NOTE</strong>: Currently only stream ciphers are supported, because the cipher RNG
implementation doesn't buffer pre-generated random data.</p>
<h2 id="xed448-goldilocks-and-xed25519">X/Ed448-Goldilocks and X/Ed25519</h2>
<p>Just a short note on Curve448: Private and public keys have a different key
size: The private key has 456 bit, while the public key has 448 bit. Both key
sizes are supported for key generation and result in the same key sizes for
the private (456 bit) and the public (448 bit) key. The private key of a key
pair will always identify with 456 bit, while the public key will always
identify with 448 bit - no matter which key size was chosen for key pair
generation.</p>
<p>The Ed448 signature is context based, but currently only an empty byte array
is being used as context data. Instead of a context you should use the purpose
free text, which can be given to the signature methods of <code>wan24-Crypto</code>.</p>
<p>XEd25519 and XEd448 convert the private Ed25519/448 key to X25519/448 for key
exchange. The private key stores only the Ed25519/448 information, while the
public key stores both, the Ed25519/448 and the X25519/448 informations (and
therefor require a custom serialization format). You can derive Ed25519/448
private keys from a XEd25519/448 private key, and XEd25519/448 private keys
from a Ed25519/448 private key.</p>
<p>Using the <code>ToX25519/448PrivateKey</code> extension methods for the
<code>Ed25519/448PrivateKeyParameters</code> a conversion to X25519/448 is possible now
(if you want to use the Bouncy Castle API directly).</p>
<p><strong>WARNING</strong>: Different Ed25519/448 keys may convert to equal X25519/448 keys,
so be aware of possible collisions!</p>

</article>
                </div>

                <div class="copyright-footer">
                    <span>(c) 2023 Andreas Zimmermann, wan24.de</span>
                </div>
            </main>
        </div>


        <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
        <script type="text/javascript" src="styles/jquery.twbsPagination.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/jquery.mark.min.js"></script>
        <script type="text/javascript" src="styles/url.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js"></script>
        <script type="text/javascript" src="styles/docfx.js"></script>
        <script type="text/javascript" src="styles/main.js"></script>
        <script type="text/javascript" src="styles/singulink.js"></script>    </body>
</html>
